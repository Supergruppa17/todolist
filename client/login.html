<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>Login</title>
    <script src="superfetch2.js"></script>
	<link rel="stylesheet" type="text/css" href="login.css">
</head>

<body>
	<div id="form">
		<img src="Logo_todolist.png">
		<h1>Want to organize your life?</h1>
		<hr>
		<br>
		<input id="inpLoginname" placeholder="username">
		<input type="password" id="inpPassword" placeholder="password">
		<button id="btnCreate">login</button>
		<br>s
		<h4>Don't have an account? We can fix that!</h4>
		<button id="btnNewuser">signup</button>
	</div>


</body>

<script>

    var inpLoginname = document.getElementById("inpLoginname");
    var inpPassword = document.getElementById("inpPassword");
    var btnCreate = document.getElementById("btnCreate");
	var btnNewuser = document.getElementById("btnNewuser");

    //button click ---------------------------------
    btnCreate.onclick = function() {


        var upload = JSON.stringify({
            login_name: inpLoginname.value,
            password: inpPassword.value
        });

        var url = "http://localhost:3000/todolist/users/auth/";

        var cfg = {
            method: "POST",
            body: upload
        }

        superfetch(url, "json", succ, error, cfg);

    }


	btnNewuser.onclick = function() {

		console.log("hi");
		window.location.href = "createuser.html";
	}


    //success --------------------------------------
    function succ(data) {

		console.log("hurra")

        //save logindata/token to localStorage

        if(data.token) {

            localStorage.setItem("logindata", JSON.stringify(data));
            window.location.href = "showlist.html";
        }
         else {
            txtMsg.innerHTML = "Something went wrong. Please try again later";
		 }

    }

    //error ----------------------------------------
    function error(err) {
        console.log(err);
    }



</script>



</html>
