<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>test Show List</title>
    <script src="superfetch2.js"></script>
	<link rel="stylesheet" type="text/css" href="showlist.css">
</head>

<body>

    <h1 id="txtName"></h1>
	<hr>
    <br>
	<div id="form">
		<button id="btnCreate">create new list</button>
		<br>
		<br>
		<input id="inpId">
		<button id="btnDelete">delete list</button>
		<br>
		<br>
		<input id="inpIdOpen">
		<button id="btnOpen" >open</button>
	</div>
	<hr>


</body>

<script>

    var txtName = document.getElementById("txtName");

    var logindata = JSON.parse(localStorage.getItem("logindata"));
    var url = "http://localhost:3000/todolist/list/?token=" + logindata.token;

    txtName.innerHTML = "Logged in as: " + logindata.login_name;

    superfetch(url, "json", succ, error);



    //success --------------------------------------
    function succ(data) {


        var inpId = document.getElementById("inpId");
        var btnDelete = document.getElementById("btnDelete");

        var inpIdOpen = document.getElementById("inpIdOpen");
        var btnOpen = document.getElementById("btnOpen");
        var btnCreate = document.getElementById("btnCreate");






        btnDelete.onclick = function() {

			window.location.href = "showlist.html";

            var token = JSON.parse(localStorage.getItem("logindata")).token;
            var url = "http://localhost:3000/todolist/list/?list_id=" + inpId.value + "&token=" + token; ;
            superfetch(url, "json", delSucc, error, {method: "DELETE"});


        }

        btnOpen.onclick = function() {
                console.log("Hei");


                localStorage.setItem("listeinfo", inpIdOpen.value);

                window.location.href = "showitem.html";

        }
        btnCreate.onclick = function() {
            window.location.href = "createlist.html";
        }

        //delete success -------------------------------
        function delSucc(data) {
            console.log(data);
        }


        console.log(data); //Hello World!

        for (var i = 0; i < data.length; i++) {
			var d =  new Date(data[i].due_date).toDateString();
            var div = document.createElement("div");
            div.innerHTML += "<h2>" + data[i].list_name + "</h2>";
            div.innerHTML += "<h3>List ID: " + data[i].list_id + "</h3>";
            div.innerHTML += "<h3>Due date : " + d + "</h3>";
            var hr = document.createElement("hr");

            document.body.appendChild(div);
            document.body.appendChild(hr);
        }



    }

    //error ----------------------------------------
    function error(err) {
        console.log(err);
    }



</script>

</html>
